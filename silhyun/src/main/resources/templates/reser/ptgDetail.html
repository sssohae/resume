<!doctype html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{home/layout}">

<head>
<!-- metas -->
<meta charset="utf-8">
<meta name="author" content="pxdraft" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" content="ShopApp - eCommerce Bootstrap 5 Template" />
<meta name="description"
	content="ShopApp - eCommerce Bootstrap 5 Template" />
<!-- title -->
<title>작가 디테일 페이지</title>
<!-- Favicon -->
<!-- CSS Template -->
	<style>
		/* 스타일링 */
		div.minimalistBlack {
			width: 70%;
			border-collapse: collapse;
			text-align: left;
		}

		#attl {
			padding-left: 15px;
		}

		.divTable.minimalistBlack .divTableCell,
		.divTable.minimalistBlack .divTableHead {
			padding: 5px 4px;
		}

		.divTable.minimalistBlack .divTableBody .divTableCell {
			font-size: 13px;
		}

		.divTable.minimalistBlack .divTableHeading {
			background: #B96F4A;
			border-bottom: 1px solid #000000;
		}

		.divTable.minimalistBlack .divTableHeading .divTableHead {
			font-size: 15px;
			font-weight: bold;
			color: #000000;
		}

		.minimalistBlack .tableFootStyle {
			font-size: 14px;
		}

		/* DivTable.com */
		.divTable {
			display: table;
		}

		.divTableRow {
			display: table-row;
			border-bottom: 1px solid steelblue;
		}

		.divTableHeading {
			display: table-header-group;
			text-align: center;
		}

		.divTableCell,
		.divTableHead {
			display: table-cell;
			text-align: center;
		}

		.divTableHeading {
			display: table-header-group;
		}

		.divTableFoot {
			display: table-footer-group;
		}

		.divTableBody {
			display: table-row-group;
		}

		/* 모달 창 스타일링 */
		.modal {
			display: none;
			position: fixed;
			z-index: 1;
			padding-top: 100px;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			overflow: auto;
			background-color: rgba(0, 0, 0, 0.4);
		}

		.modal-content {
			background-color: #fefefe;
			margin: auto;
			padding: 20px;
			border: 1px solid #888;
			width: 50%;
		}

		.close {
			color: #aaa;
			float: right;
			font-size: 28px;
			font-weight: bold;
		}

		.close:hover,
		.close:focus {
			color: black;
			text-decoration: none;
			cursor: pointer;
		}

		.ansBox{
			padding-left: 10px;

		}
		a{
			text-decoration-line: none;
		}
		button {
			margin-left: 10px;
			
		}

		
		

	</style>
</head>

<body>
    <div layout:fragment="content">
    <!-- Skippy & Prload -->
    <!-- skippy -->
<a id="skippy" class="skippy visually-hidden-focusable overflow-hidden" href="#content">
    <div class="container">
        <span class="u-skiplink-text">Skip to main content</span>
    </div>
</a>
<!-- End skippy -->
    <!-- 
    ========================
        Wrapper 
    ========================
    -->
    <div class="wrapper">
        <!-- Main -->
        <main>
            <!-- Page Title -->
            <div class="bg-no-repeat bg-cover bg-right-center position-relative">
                <div class="position-absolute top-0 end-0 start-0 bottom-0 opacity-3 bg-dark"></div>
                <!-- Header Height Bar -->
                <div class="header-height-bar border-bottom opacity-3"></div>
                <div class="container py-6 position-relative">
                    <div class="row align-items-center">
                        <div class="col-lg-6 my-2" >
                            <h1 class="m-0 h4 text-center text-lg-start text-white">🍓 [[${ptg[0].name}]] 🍓</h1>
                            	<input type="hidden" id="ctgrNum" th:value="${ptg[0].ptgId}">
								<input type="hidden" id="ctgr" value="A">
                        </div>
                        <div class="col-lg-6 my-2">
                            <ol class="breadcrumb breadcrumb-light m-0 small justify-content-center justify-content-lg-end">
                                <li class="breadcrumb-item"><a class="text-nowrap" href="/">Home</a></li>
                                <li class="breadcrumb-item text-nowrap active" aria-current="page">예약하기</li>
                                <li class="breadcrumb-item text-nowrap active" aria-current="page">작가</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Page Title -->
           <!-- 작가 상세보기 -->
            <section class="product-details-02 py-6">
				<div class="container">
					<div class="row">
						<!-- 작가사진 -->
							<div class="col-lg-7 lightbox-gallery product-gallery">
								<div class="swiper swiper_gallery_v">
									<div class="swiper-wrapper">
										<div class="swiper-slide">
											<div class="pd-gallery-slide">
												<img th:src="${ptg[0].profile}" class="img-fluid" title=""
													alt="" style="width: 600px; height: 600px">
											</div>
										</div>
									</div>
								</div>
							</div>
							<!-- End 작가사진 -->
							
							<div class="col-lg-5 ps-lg-5">
								<div class="product-detail pt-4 pt-lg-0">
									<div class="products-title-box">
										<div class="products-title">
											<h6 th:if="${ptg[0].stName} != null">[[${ptg[0].stName}]]
												소속</h6>
											<h6 th:if="${ptg[0].stName} == null">프리랜서</h6>
											<h4 class="h4">[[${ptg[0].name}]]</h4>
										</div>
										<div class="product-wishlist" >
											<a class="btn zzim" style="width: 50px;height: 50px;margin-right: 50px"> 
											<i class="zzim-icon bi-person" style="font-size: 30px"></i>
											</a><br>
											<span class="text-primary" style="margin-left: 21px">[[${ptg[0].zzims}]]</span>

										</div>
									</div>
									<div class="product-description itr" >
										<pre><p style="height: 300px;">[[${ptg[0].itr}]]</p></pre>
										 <i class="bi-instagram" style="font-size: 15px"></i><span>  인스타그램 [[${ptg[0].inst}]]</span>
									</div>

									<div class="product-detail-actions d-flex flex-wrap">
										<div class="cart-button">
											<button class="btn btn-primary pd-cart-btn"
												th:onclick="|location.href='@{/pay/reserList/{ptgId}(ptgId=${ptg[0].ptgId})}'|">
												예약하러가기</button>
										</div>
									</div>
									<div class="product-metas small">

										<p class="theme-link m-0">
											<label class="m-0 text-dark fw-500 w-100">Share:</label> <a
												class="icon icon-sm bg-primary text-white rounded me-1"
												href="#"> <i class="bi bi-facebook"></i>
											</a> <a class="icon icon-sm bg-primary text-white rounded me-1"
												href="#"> <i class="bi bi-twitter"></i>
											</a> <a class="icon icon-sm bg-primary text-white rounded me-1"
												href="#"> <i class="bi bi-instagram"></i>
											</a> <a class="icon icon-sm bg-primary text-white rounded me-1"
												href="#"> <i class="bi bi-linkedin"></i>
											</a>
										</p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</section>
				<!-- End Product Details -->
				<!-- Product Tabs -->
				<section class="product-detail-tab-02">
					<div class="container">
						<div class="product-tabs">
							<ul class="nav product-nav-tabs-02" id="myTab_02" role="tablist">
								<li class="nav-item" role="presentation"><a href="#"
									class="nav-link active" id="pd_description_tab_02"
									data-bs-toggle="tab" data-bs-target="#pd_description_02"
									role="tab" aria-controls="pd_description_02"
									aria-selected="true">Description</a></li>
								<li class="nav-item" role="presentation"><a href="#"
									class="nav-link" id="pd_information_tab_02"
									data-bs-toggle="tab" data-bs-target="#px_information_02"
									role="tab" aria-controls="px_information_02"
									aria-selected="false">Portfolio</a></li>
								<li class="nav-item" role="presentation"><a href="#"
									class="nav-link" id="pd_QA_tab_02" data-bs-toggle="tab"
									data-bs-target="#pd_QA_02" role="tab" aria-controls="pd_QA_02"
									aria-selected="false">Q&A</a></li>
								<li class="nav-item" role="presentation"><a href="#"
									class="nav-link" id="pd_reviews_tab_02" data-bs-toggle="tab"
									data-bs-target="#pd_reviews_02" role="tab"
									aria-controls="pd_reviews_02" aria-selected="false">Reviews</a>
								</li>
							</ul>

							<div class="tab-content" id="myTab_02Content">
								<div class="tab-pane fade show active" id="pd_description_02"
									role="tabpanel" aria-labelledby="pd_description_tab_02">
									<!--Description-->
									<div class="row">
										<div class="col-lg-15">
											<blockquote
												class="bg-gray-100 p-3 lead fw-400 mt-5 text-dark border-start border-primary border-5">
												<ol class="list-type-01 list-unstyled pt-2 mb-4">
													<li><h5>취소 및 환불 규정</h5></li> 가. 기본 환불 규정
													<br> 1. 전문가와 의뢰인의 상호 협의하에 청약 철회 및 환불이 가능합니다.
													<br> 2. 섭외, 대여 등 사전 준비 도중 청약 철회 시, 해당 비용을 공제한 금액을 환불
													가능합니다.
													<br> 3. 촬영 또는 편집 작업 착수 이후 청약 철회 시, 진행된 작업량 또는 작업 일수를
													산정한 금액을 공제한 금액을 환불 가능합니다.
													<br>
													<br>
													<li><h5>환불 가이드라인</h5></li> (1) 기획 단계에서 청약 철회: 총 결제 금액의 최대
													80%까지 환불 가능
													<br> (2) 작업 착수 후 청약 철회: 총 결제 금액의 최대 20%까지 환불 가능
													<br> (3) 작업 50% 완료 후 청약 철회: 총 결제 금액의 최대 10%까지 환불 가능
													<br> (4) 작업 100% 완료 후 청약 철회 : 환불 불가
													<br>
													<br> 나. 전문가 책임 사유
													<br> 1. 소비자 피해 보상 규정에 의거하여 촬영 원본의 멸실 및 재해로 인한 피해 발생 시,
													전액 환불합니다.
													<br> 2. 작업 기간 미준수, 작업 태만 및 이에 상응하는 전문가 책임으로 인한 청약 철회
													시, 환불 및 촬영 원본 제공이 가능합니다.
													<br>
													<br> 다. 의뢰인 책임 사유
													<br> 작업이 시작되면 단순 변심 또는 의뢰인 책임 사유로 인한 전액 환불이 불가능합니다.
													<br>
												</ol>
											</blockquote>
										</div>
									</div>
								</div>
								<!--Portfolio-->
								<div class="tab-pane fade" id="px_information_02"
									role="tabpanel" aria-labelledby="pd_information_tab_02"
									style="text-align: center;">
									<div class="row">
										<div class="col-lg-4 mb-3" th:each="ptgd : ${ptg}">
											<div class="position-relative hover-scale">
												<div class="hover-scale-in">
													<a href="#"> <img class="w-100" th:src="${ptgd.phoRt}"
														title="" alt="" style="width: 400px; height: 400px">
													</a>
												</div>
											</div>
										</div>
									</div>
									<br> <a
										th:href="@{/silhyun/portfolio/{ptgId}(ptgId=${ptg[0].ptgId})}"><button
											class="btn btn-primary" style="align-content: right;">더보러가기</button></a>
								</div>

								<!--Q&A-->
								<div class="tab-pane fade" id="pd_QA_02" role="tabpanel"
									aria-labelledby="pd_QA_tab_02">
									<div class="row">
										<div class="col-lg-8 pe-lg-8">
											<div align="center" class="ansArea" style="width: 1300px">
												<div class="divTable minimalistBlack">
													<div class="divTableHeading">
														<div class="divTableRow">
															<div class="divTableHead" style="width: 200px;">제목</div>
															<div class="divTableHead" style="width: 120px;">작성자</div>
															<div class="divTableHead" style="width: 120px;">작성날짜</div>
															<div class="divTableHead" style="width: 120px;">답변상태</div>
															<div class="divTableHead" style="width: 220px;"></div>
														</div>
													</div>
													<div class="divTableBody qstArea"></div>
												</div>
												<div></div>
												<div id="textBox"></div>
												<br> <br>
												<button id="new-post-btn" class="btn btn-outline-secondary btn-sm">문의하기</button>

												<!-- 문의 모달 -->
												<div id="myModal" class="modal">
													<!-- 모달 창 내용 -->
													<div class="modal-content">
														<span class="close">&times;</span>
														<h2>상품 문의</h2>
														<form>
															<label for="title">제목:</label> <input type="text" id="title" class="title" name="title"
																placeholder="제목을 입력하세요..." style="width: 400px;">
															<br> <br> <label for="content">내용:</label>
															<textarea id="qstCntn" name="qstCntn" rows="5" placeholder="내용을 입력하세요..."
																style="width: 400px;"></textarea>
															<br> <input type="checkbox" class="secChk" id="secChk" name="isSecret">
															<label for="isSecret">비밀글</label> <br> <br>
															<button type="button" id="send" class="btn btn-outline-secondary btn-sm">작성</button>
															<button type="reset" id="cancel" class="btn btn-outline-secondary btn-sm">취소</button>
														</form>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>

								<!--후기-->
								<div class="tab-pane fade" id="pd_reviews_02" role="tabpanel"
									aria-labelledby="pd_reviews_tab_02">
									<div id="reviews">
										<div></div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</section>
				<!-- End Product Tabs -->
				<form>
					<input type="hidden" name="id" th:value="${session.id}"> 
					<input type="hidden" name="ctgrNum" th:value="${ptg[0].ptgId}">
				</form>
			</main>
			<!-- End Main -->



			<script th:inline="javascript">
		
		/*<![CDATA[*/   
        var role = /*[[${session.role}]]*/
        var name = /*[[${session.id}]]*/
       /*]]*/
       console.log(role[0].authority)
       
       console.log(name)
    </script>

			<script src="/js/review/review.js"></script>
			<script src="/js/aoQst.js"></script>

		</div>
		<!-- 
    ========================
       End Wrapper 
    ========================
    -->
		<!-- End script start -->
		<script>
    //    let ptgId = $("#pthVal").text();
    //    console.log(ptgId);
       
    //        $.ajax({
    //            url:"/ptgDetail/"+ptgId

    //        })
    //        .then(result =>{
    //            console.log(result)
    //        })

    
//리뷰
// 	     function goReivew(){
// 	    	 ajaxReiew({pageNum: 1, amount: 5})
// 	     }
		
// 		ajaxReiew({pageNum: 1, amount: 5})
		
// 		function ajaxReiew(data){
// 			$.ajax({
// 				url: '/ajaxCall',
// 				data: data,
// 				success: function(res){
// 					console.log(res)
// 					$('#reviews').empty().append(res)
// 				},
// 				error: function(err){
// 					console.log(err)
// 				}
// 			})
// 		}

	//📌찜 호출 
	let id = $('input[name="id"]').val()
	let ctgrNum = $('input[name="ctgrNum"]').val()
	$(document).ready(function(){
	    $.ajax({  //해당 유저가 해당 작가를 찜 했는지
	        url:`/silhyun/isZzim/${id}/${ctgrNum}`
	    }).then(result => {
	        console.log(result)
	        if(result){ 
	            if($('.zzim-icon').hasClass('bi-person')){
	                $('.zzim-icon').removeClass('bi-person').addClass('bi-person-heart')
	            }
	        }else{
                if($('.zzim-icon').hasClass('bi-person-heart')){
                    $('.zzim-icon').removeClass('bi-person-heart').addClass('bi-person')
                }
	        }
	    })
	
	})
	//찜 버튼 클릭 이벤트
	$('.zzim-icon').on('click',function(){  
	
	    if($(this).hasClass('bi-person')){  //찜이 되어있지 않으면 찜 추가
	        $.ajax({
	            url:'/silhyun/insertZzim',
	            type:'post',
	            data:JSON.stringify({
	                id: id,
	                ctgrNum : ctgrNum
	            }),
	            contentType: 'application/json'
	        }).then(result=>{
	            $(this).removeClass('bi-person').addClass('bi-person-heart') //아이콘 변경
	            
	            //찜 개수 +
	           let countZzim = parseInt($('.product-wishlist').find('span').text())
	           $('.product-wishlist').find('span').text(countZzim + 1);
	        })
	    }else{  //이미 찜이 되어 있으면 찜 삭제
	        $.ajax({
	            url:'/silhyun/delZzim',
	            type:'post',
	            data:JSON.stringify({
	                id: id,
	                ctgrNum : ctgrNum
	            }),
	            contentType: 'application/json',
				headers: {
				        'X-HTTP-Method-Override': 'DELETE'
				}
	        }).then(result =>{
	            $(this).removeClass('bi-person-heart').addClass('bi-person')  //아이콘 변경
	
	            //찜 개수 -
	            let countZzim = parseInt($('.product-wishlist').find('span').text())
	            $('.product-wishlist').find('span').text(countZzim - 1);
	        })
	    }
	})

// 	$('.product-description.itr').find('p').text()
// 	let enterItr = $('.product-description.itr').find('p').text().replace("\r\n","<br>")
// 	console.log(enterItr)

    </script>

	</div>
</body>

</html>